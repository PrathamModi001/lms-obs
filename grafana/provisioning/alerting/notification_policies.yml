# =============================================================================
# Grafana Alerting Provisioning - Notification Policies
# Defines HOW alerts are routed to contact points
# =============================================================================

apiVersion: 1

policies:
  - orgId: 1
    # Default receiver when no other match
    receiver: default-alerts
    
    # Group alerts by these labels
    group_by: ['grafana_folder', 'alertname']
    
    # Timing configuration
    group_wait: 30s
    group_interval: 5m
    repeat_interval: 4h
    
    # Child routes for specific alert handling
    routes:
      # Critical severity alerts
      - receiver: critical-alerts
        object_matchers:
          - ['severity', '=', 'critical']
        group_wait: 10s
        repeat_interval: 1h
        continue: false
      
      # Warning severity alerts
      - receiver: warning-alerts
        object_matchers:
          - ['severity', '=', 'warning']
        group_wait: 1m
        repeat_interval: 6h
        continue: false
      
      # Infrastructure alerts (high priority)
      - receiver: critical-alerts
        object_matchers:
          - ['category', '=', 'infrastructure']
        group_wait: 10s
        continue: false
